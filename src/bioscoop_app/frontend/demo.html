<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8"/>
    <title></title>
</head>
<body>
<p>Dit is een tweede pagina!</p>
<img src="https://vuejs.org/images/logo.png"/>
<form enctype="multipart/form-data" action="/upload/image" method="post">
    <input type="file" id="fileSelect"/>
    <input type="text" value="hoi"/>
    <button type="button" id="sendbutton">Upload file</button>
</form>
<script>
    if (document.querySelector("#sendbutton") !== null) {
        document.querySelector("#sendbutton").addEventListener("click", validateSendForm);
    }

    function validateSendForm() {
        var file = document.getElementById('fileSelect').files[0];
        new Promise((resolve => {
            var reader = new FileReader();
            reader.readAsDataURL(file);
            reader.onload = function () {
                resolve(reader.result);
            };
            reader.onerror = function (error) {
                console.log('Error: ', error);
            };
        })).then((result) => {
            var request = {
                "method": "post",
                "url": "/file/upload",
                "parameters": null,
                "postData": {"file": result}
            };
            window.cefQuery({
                request: JSON.stringify(request),
                onSuccess: function (response) {
                    console.log(response);
                }, onFailure: function (err, msg) {
                    console.log(err, msg);
                }
            });
        })
    }


</script>
</body>
</html>